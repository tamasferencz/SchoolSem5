<Window x:Class="MalomWPF.View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MalomWPF"
        xmlns:vm="clr-namespace:MalomWPF.ViewModel"
        mc:Ignorable="d"
        Title="Malom"
        Width="1600" Height="950">

    <Window.Resources>
        <ControlTemplate x:Key="CircleButtonTemplate" TargetType="Button">
            <Grid>
                <Ellipse Fill="{TemplateBinding Background}"
                         Stroke="Black"
                         StrokeThickness="1"/>
                <ContentPresenter HorizontalAlignment="Center"
                                  VerticalAlignment="Center"></ContentPresenter>
            </Grid>
        </ControlTemplate>
    </Window.Resources>

    <Grid>
        <Canvas Margin="20">
            <!-- Külső négyzet -->
            <Line X1="150" Y1="150" X2="480" Y2="150" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="150" X2="810" Y2="150" Stroke="Black" StrokeThickness="3" />
            <Line X1="810" Y1="150" X2="810" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="810" Y1="480" X2="810" Y2="810" Stroke="Black" StrokeThickness="3" />
            <Line X1="810" Y1="810" X2="480" Y2="810" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="810" X2="150" Y2="810" Stroke="Black" StrokeThickness="3" />
            <Line X1="150" Y1="810" X2="150" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="150" Y1="480" X2="150" Y2="150" Stroke="Black" StrokeThickness="3" />

            <!-- Középső négyzet -->
            <Line X1="260" Y1="260" X2="480" Y2="260" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="260" X2="700" Y2="260" Stroke="Black" StrokeThickness="3" />
            <Line X1="700" Y1="260" X2="700" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="700" Y1="480" X2="700" Y2="700" Stroke="Black" StrokeThickness="3" />
            <Line X1="700" Y1="700" X2="480" Y2="700" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="700" X2="260" Y2="700" Stroke="Black" StrokeThickness="3" />
            <Line X1="260" Y1="700" X2="260" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="260" Y1="480" X2="260" Y2="260" Stroke="Black" StrokeThickness="3" />

            <!-- Belső négyzet -->
            <Line X1="370" Y1="370" X2="480" Y2="370" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="370" X2="590" Y2="370" Stroke="Black" StrokeThickness="3" />
            <Line X1="590" Y1="370" X2="590" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="590" Y1="480" X2="590" Y2="590" Stroke="Black" StrokeThickness="3" />
            <Line X1="590" Y1="590" X2="480" Y2="590" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="590" X2="370" Y2="590" Stroke="Black" StrokeThickness="3" />
            <Line X1="370" Y1="590" X2="370" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="370" Y1="480" X2="370" Y2="370" Stroke="Black" StrokeThickness="3" />

            <!-- Négyzetek közötti összekötők -->
            <Line X1="480" Y1="150" X2="480" Y2="260" Stroke="Black" StrokeThickness="3" />
            <Line X1="810" Y1="480" X2="700" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="810" X2="480" Y2="700" Stroke="Black" StrokeThickness="3" />
            <Line X1="150" Y1="480" X2="260" Y2="480" Stroke="Black" StrokeThickness="3" />

            <Line X1="480" Y1="260" X2="480" Y2="370" Stroke="Black" StrokeThickness="3" />
            <Line X1="700" Y1="480" X2="590" Y2="480" Stroke="Black" StrokeThickness="3" />
            <Line X1="480" Y1="700" X2="480" Y2="590" Stroke="Black" StrokeThickness="3" />
            <Line X1="260" Y1="480" X2="370" Y2="480" Stroke="Black" StrokeThickness="3" />

            <ItemsControl ItemsSource="{Binding Positions}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemContainerStyle>
                    <Style TargetType="ContentPresenter">
                        <Setter Property="Canvas.Left" Value="{Binding X}"/>
                        <Setter Property="Canvas.Top" Value="{Binding Y}"/>
                    </Style>
                </ItemsControl.ItemContainerStyle>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Button Width="100" Height="100"
                                Background="{Binding Background}"
                                Template="{StaticResource CircleButtonTemplate}"
                                Command="{Binding DataContext.PositionClickCommand,
                                                  RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                CommandParameter="{Binding Index}"/>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Canvas>

        <!-- Jobb oldali panel -->
        <StackPanel Orientation="Vertical"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Margin="0,150,50,0">
            <TextBlock Text="{Binding InfoText}"
                       FontSize="16"
                       FontWeight="Bold"
                       TextWrapping="Wrap"/>

            <Button Content="Új játék"
                    Width="200" Height="60"
                    Margin="0,20,0,0"
                    FontSize="16"
                    FontWeight="Bold"
                    Command="{Binding ResetCommand}"/>

            <Button Content="Mentés"
                    Width="200" Height="60"
                    Margin="0,10,0,0"
                    FontSize="16"
                    FontWeight="Bold"
                    Command="{Binding SaveCommand}"/>

            <Button Content="Betöltés"
                    Width="200" Height="60"
                    Margin="0,10,0,0"
                    FontSize="16"
                    FontWeight="Bold"
                    Command="{Binding LoadCommand}"/>
        </StackPanel>
    </Grid>
</Window>
